# API Documentation Template
# Standardized template for creating API documentation

metadata:
  document_type: "API_DOCS"
  version: "1.0.0"
  template_id: "api-docs-tmpl"
  description: "API documentation template"
  downstream_processing:
    - task_creation
    - story_generation
    - epic_planning
    - development_workflow

structure:
  header:
    title: "API Documentation: {{api_name}}"
    subtitle: "{{api_version}}"
    created_date: "{{current_date}}"
    author: "{{author}}"
    project: "{{project_name}}"
    version: "{{version}}"
  
  sections:
    - name: "overview"
      title: "Overview"
      required: true
      content_template: |
        ## API Description
        {{api_description}}
        
        ## Base URL
        {{base_url}}
        
        ## Authentication
        {{authentication_method}}
        
        ## Rate Limiting
        {{rate_limiting}}
    
    - name: "endpoints"
      title: "Endpoints"
      required: true
      content_template: |
        ## API Endpoints
        
        {{#each endpoints}}
        ### {{method}} {{path}}
        {{description}}
        
        **Parameters:**
        {{parameters}}
        
        **Request Body:**
        {{request_body}}
        
        **Response:**
        {{response}}
        
        **Example:**
        {{example}}
        
        ---
        {{/each}}
    
    - name: "data_models"
      title: "Data Models"
      required: true
      content_template: |
        ## Data Models
        
        {{#each data_models}}
        ### {{model_name}}
        {{description}}
        
        **Properties:**
        {{properties}}
        
        **Example:**
        {{example}}
        
        ---
        {{/each}}
    
    - name: "error_handling"
      title: "Error Handling"
      required: true
      content_template: |
        ## Error Responses
        
        ### HTTP Status Codes
        {{status_codes}}
        
        ### Error Response Format
        {{error_format}}
        
        ### Common Error Codes
        {{common_errors}}
    
    - name: "examples"
      title: "Examples"
      required: true
      content_template: |
        ## Usage Examples
        
        ### Authentication Example
        {{auth_example}}
        
        ### Basic Usage Example
        {{basic_example}}
        
        ### Advanced Usage Example
        {{advanced_example}}
    
    - name: "sdk_references"
      title: "SDK References"
      required: false
      content_template: |
        ## SDK and Client Libraries
        
        {{#each sdks}}
        ### {{sdk_name}}
        {{description}}
        
        **Installation:**
        {{installation}}
        
        **Usage:**
        {{usage}}
        
        ---
        {{/each}}

variables:
  api_name:
    type: "string"
    required: true
    description: "Name of the API"
    example: "User Management API"
  
  api_version:
    type: "string"
    required: true
    description: "API version"
    example: "v1.0.0"
  
  api_description:
    type: "text"
    required: true
    description: "Description of the API functionality"
    example: "RESTful API for user management operations"
  
  base_url:
    type: "string"
    required: true
    description: "Base URL for the API"
    example: "https://api.example.com/v1"
  
  authentication_method:
    type: "text"
    required: true
    description: "Authentication method and requirements"
    example: "Bearer token authentication required"
  
  rate_limiting:
    type: "text"
    required: false
    description: "Rate limiting information"
    example: "100 requests per minute per API key"
  
  endpoints:
    type: "array"
    required: true
    description: "List of API endpoints"
    item_type: "object"
    item_schema:
      method:
        type: "string"
        required: true
        example: "GET"
      path:
        type: "string"
        required: true
        example: "/users"
      description:
        type: "text"
        required: true
        example: "Retrieve list of users"
      parameters:
        type: "text"
        required: false
        example: "query: page, limit"
      request_body:
        type: "text"
        required: false
        example: "JSON object with user data"
      response:
        type: "text"
        required: true
        example: "JSON array of user objects"
      example:
        type: "text"
        required: true
        example: "curl -X GET https://api.example.com/v1/users"
  
  data_models:
    type: "array"
    required: true
    description: "List of data models"
    item_type: "object"
    item_schema:
      model_name:
        type: "string"
        required: true
        example: "User"
      description:
        type: "text"
        required: true
        example: "User data model"
      properties:
        type: "text"
        required: true
        example: "id, name, email, created_at"
      example:
        type: "text"
        required: true
        example: '{"id": 1, "name": "John Doe", "email": "john@example.com"}'
  
  status_codes:
    type: "text"
    required: true
    description: "HTTP status codes used by the API"
    example: "200 OK, 201 Created, 400 Bad Request, 401 Unauthorized, 404 Not Found, 500 Internal Server Error"
  
  error_format:
    type: "text"
    required: true
    description: "Standard error response format"
    example: '{"error": {"code": "ERROR_CODE", "message": "Error description"}}'
  
  common_errors:
    type: "text"
    required: true
    description: "Common error codes and their meanings"
    example: "INVALID_CREDENTIALS, MISSING_PARAMETER, RATE_LIMIT_EXCEEDED"
  
  auth_example:
    type: "text"
    required: true
    description: "Authentication example"
    example: "curl -H 'Authorization: Bearer YOUR_TOKEN' https://api.example.com/v1/users"
  
  basic_example:
    type: "text"
    required: true
    description: "Basic usage example"
    example: "curl -X GET https://api.example.com/v1/users"
  
  advanced_example:
    type: "text"
    required: false
    description: "Advanced usage example"
    example: "curl -X POST https://api.example.com/v1/users -d '{\"name\":\"John\",\"email\":\"john@example.com\"}'"
  
  sdks:
    type: "array"
    required: false
    description: "List of SDKs and client libraries"
    item_type: "object"
    item_schema:
      sdk_name:
        type: "string"
        required: true
        example: "Python SDK"
      description:
        type: "text"
        required: true
        example: "Official Python client library"
      installation:
        type: "text"
        required: true
        example: "pip install example-api-client"
      usage:
        type: "text"
        required: true
        example: "from example_api import Client; client = Client(api_key='your_key')"

validation:
  required_fields:
    - api_name
    - api_version
    - api_description
    - base_url
    - authentication_method
    - endpoints
    - data_models
    - status_codes
    - error_format
    - common_errors
    - auth_example
    - basic_example
  
  field_validation:
    api_name:
      min_length: 3
      max_length: 100
      pattern: "^[a-zA-Z0-9\\s\\-_]+$"
    
    api_version:
      pattern: "^v?\\d+\\.\\d+\\.\\d+$"
    
    base_url:
      pattern: "^https?://[a-zA-Z0-9.-]+(/.*)?$"

output_format:
  markdown: true
  yaml: true
  json: true
  openapi: true
  
processing:
  task_creation:
    enabled: true
    template: "task-creation-tmpl.yaml"
    fields_mapping:
      task_title: "api_name"
      task_description: "api_description"
      technical_requirements: "endpoints"
      deliverables: "data_models"
  
  story_generation:
    enabled: true
    template: "story-generation-tmpl.yaml"
    fields_mapping:
      story_title: "api_name"
      story_description: "api_description"
      acceptance_criteria: "endpoints"
      test_scenarios: "examples"
  
  epic_planning:
    enabled: true
    template: "epic-planning-tmpl.yaml"
    fields_mapping:
      epic_title: "api_name"
      epic_description: "api_description"
      business_value: "api_description"
      deliverables: "data_models"
